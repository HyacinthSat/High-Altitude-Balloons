# 项目开发与测试日志

---

## 📅 2025/06/21

### ✅ 测试日志

#### 气球固件部分

1. [有待调整]  `payload` 参数结构不便于阅读  
2. [严重故障]  NACK 命令存在失效的情况  
3. [严重故障]  图像传输期间命令完全不响应  
4. [严重故障]  温度在最开始遥测帧中正常，后续固定为 53.33℃  
5. [非预期行为] 第一张图编号为 0，被误判为 ERR_NONE，未进行传输  
6. [非预期行为] 修改画幅与周期后图像连发，疑似调制完成过快导致休眠时链路仍未发送完  

✅ **已修复：** 1, 2, 3, 4, 5, 6

---

## 📅 2025/06/22

### ✅ 开发日志

#### 错误修复记录


1. [完成] 重构了 `payload` 参数         
2. [完成] 修复了应答流程  
3. [完成] 修复图像传输期间命令不响应逻辑  
4. [鸽了] 问题暂未查明，交付后期处理  
5. [完成] 与 `payload` 重构一并解决  
6. [成功] 新增队列检查机制，确保发送完成后才进入周期延时  

---

### ✅ 测试日志

#### 气球固件部分

1. [非预期行为] 转发器文本格式存在问题  
2. [非预期行为] GPS 指示器显示为 “~”  
3. [非预期行为] 降级状态下图像帧并非最新  
4. [非预期行为] SSDV 调制结束但未发送完，结束标记插队  
5. [非预期行为] 图传期间命令响应延迟到图传结束后才发送  
6. [非预期行为] 内部温度传感器误差大，室温 30℃ 时显示近 50℃  
7. [非预期行为] 中继关闭期间不收但也不丢弃消息，恢复后读出积压数据  
8. [严重故障]   遥测温度固定为 53.33℃，注释掉电压 ADC 后恢复  

✅ **已修复：** 1, 2, 3, 4, 5, 7, 8  
🚫 **不予处理：** 6（误差属设计固有限制）

---

#### CDTU 固件部分

- [严重故障] 长时间待机后串口设备没有发挥作用

✅ **已修复** 

---

#### 地面站部分

1. [非预期行为] 串口连接失败时未弹窗提示  
2. [非预期行为] 曾尝试连接过的串口断开时仍会弹出提示  

---

#### 其他硬件

- [修复查明] GPS 故障已确认为由天线引起

---

### 📌 TODO

- 降级状态下图像帧的实时性检查  
- 开发命令上注加密与鉴权机制

---

## 📅 2025/06/23

### ✅ 开发日志

#### 错误修复记录

1. [完成] 修复转发器逻辑，删除错误的 `CALLSIGN` 字段  
2. [完成] 修复字面量类型错误，重构 DEBUG_MODE 逻辑  
3. [完成] 删除帧降级机制，经测试确认无风险  
4. [完成] 调整错误的状态通知位置，修复结束标记时机  
5. [完成] 增加高优先级数据插队机制  
6. [放弃] 温度误差为正常范围，暂不处理  
7. [完成] 优化中继数据接收逻辑  
8. [完成] 使用寄存器重置方式解决温度传感器无效问题  

---

## 📅 2025/06/25

### ✅ 测试日志

#### 气球固件部分

- [严重错误] 图像传输接近末尾时发生丢帧或帧错误

---

## 📅 2025/06/26 - 2025/06/27

### ✅ 测试日志

#### 气球固件部分

1. [有待调整] 图传参数错误时未发送 NACK
2. [严重错误] SVGA 尺寸下存在编码问题，疑似其宽度不受支持

#### 地面站部分

1. [非预期行为] 中继窗口的返回键未显示
2. [非预期行为] 依赖文件检测机制使用相对路径，存在路径误判问题
3. [非预期行为] 信息发送失败时计数器仍然增加

### ✅ 开发日志

#### 错误修复记录

- [完成] 经测试，确认图传问题由降低 CPU 频率引起波特率紊乱，予以500ms延时
- [完成] 修复中继窗口返回键显示问题
- [完成] 修复依赖文件检测机制，使用绝对路径
- [完成] 修复信息发送失败计数器增加问题
- [完成] 修复图像传输参数错误时未发送 NACK 问题
- [完成] 修复 SVGA 下编码问题，更换为 XGA

#### 功能更新

- [完成] 增加预设图片选项，现在可以通过@@SET,SSDV_PRESET命令设置预设图片

---

## 📅 2025/06/30

### ✅ 开发日志

#### 功能更新

- [完成] 新增上行链路密码验证机制，防止未授权控制

### ✅ 测试日志

#### 气球固件部分

1. [严重错误] 发送查询命令时发生崩溃
2. [非预期行为] 命令NACK等反馈不及时，疑似图像发送结束后才进行处理

## 📅 2025/07/01

### ✅ 测试日志

#### 气球固件部分

1. [严重错误] 图像编码发生死锁触发看门狗

#### 地面站部分

1. [非预期行为] 通联窗口时钟位置偏移
2. [非预期行为] 双击选中时不会清空原有的信息
3. [非预期行为] 封装后，Debug 信息会弹出窗口

### ✅ 开发日志

#### 错误修复记录

- [完成] 查询命令由于字段缺乏而崩溃，问题已解决
- [完成] NACK同样由字段问题引起，问题已解决
- [尝试] 经过排查疑似投喂部分可能存在死锁风险，添加计数与超时计数尝试解决

